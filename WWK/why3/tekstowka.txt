Zadanie polega na policzeniu tablicy PREF. Dane jest słowo s[0], s[1], ... , s[n-1]. Dla każdego 1 <= i <= (n-1) chcemy poznać największe k (pref[i]), że s[i], s[i+1], ... s[i+k-1] (słowo zaczynające się na pozycji i, długości k) jest prefixem słowa s, tj. jest równe s[0], s[1], ... , [k-1].

Eleganckim sposobem na policzenie tej funkcji jest 'algorytm z daszkiem'. Liczymy wartości  pref dla kolejnych i: policzyliśmy już pref[0], .., pref[i-1] i chcemy policzyć pref[i]. Sytuacja wygląda jak na obrazku, gdzie już policzone wyniki pref[_] zostały też zwizaulizowane przez daszki:
W każdej chwili pamiętamy, który z dotychczas policzonych daszków sięga najdalej w prawo (na obrazku - daszek z pozycji 7, podkreślony na zielono). Będziemy korzystać z tego daszku by policzyć pref[i].

  Zauważmy, że słowo w zielonym daszku jest równe (z definicji pref) słowu czerwonemu. Chcemy znaleźć pierwsze miejsce w którym ciąg s[i], s[i+1], ... różni się odciągu s[0], s[1], .... . Zielony daszek pozwala nam na częściową odpowiedź na to pytanie: jeśli daszek kończy się na pozycji end (na obrazku end=15) to możemy łatwo poznać miejsce pierwszej różnicy między s[i], s[i+1], ...s[end] oraz s[0], s[1], ... s[end-i+1].
    W tym celu zamiast patrzeć na s[i], s[i+1], .. s[end] (podsłowo w zielonym daszku, na obrazku s[10], ... s[15]) patrzmy na dokładnie to samo podsłowo w czerwonym daszku (na obrazku na słowo s[3], s[8]). Korzystając z już policzonych wartości pref w czerwonym daszku poznajemy pierwszą różnicę.
   Tu oczywiście jest kilka przypadków. Mogło się okazać (jak w sytuacji z obrazka), że znaleźliśmy pierwsżą różnicę, która mieści się w zielonym daszku. Wtedy sprawa jest załatwiona.
  Może być też tak, że aż do końca daszka jest zgodność: że dowiedzieliśmy się że całe s[i], ... s[end] jest prefiksem s. Wtedy dalsze poszukiwanie różnicy robimy ręcznie, literka po literce. Np. w sytuacji z obrazka, kiedy liczyliśmy pref[6] to najbardziej w prawo sięgający daszek wychodził z pozycji i 3 -sięgające do pozycji 7 włącznie. Korzystając ze sposobu opisanego powyżej, dowiadujemy się, że s[6], s[7] jest prefiksem s - dalej nic się nie dowiemy, bo doszliśmy do granicy daszka. Dalej musimy sprawdzać ręcznie - i przez ręczne sprawdzenie s[7]<>s[2] dowiadujemy się, że s[6], s[7], s[8] już nie jest prefiksem s.
  W tej fazie 'ręcznego przedłużania' potencjalnie wykonujemy dużą pracę, ale jednocześnie przesuwamy w prawo ostatnią pozycję pod daszkiem! Ponieważ ta pozycja tylko przesuwa się w prawo i cały czas pozostaje w słowie, to ogólnie działamy w czasie liniowym.
  Jest jeszcze jeden przypadek - kiedy zaczynamy z pozycji i ,która jest poza jakikolwiek wcześniej policzonym daszkiem (na obrazku tak jest kiedy liczymy pref[2]). Wtedy wykonujemy ręczne przedłużanie (i, tak samo jak poprzednio, jednocześnie zwiększamy ilość pozycji pod daszkiem).
